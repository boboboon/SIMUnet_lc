Loading rhel8/default-ccl
  Loading requirement: rhel8/global rhel8/slurm rhel8/cclake-env/2024-06-01
    rhel8/cclake/base glibc/2.28/gcc/4d2cj5pu gcc-runtime/13.3.0/gcc/2sn7kkm3
    zlib-ng/2.1.6/gcc/mkjcey6m zstd/1.5.6/gcc/l5c7mfsx
    binutils/2.42/gcc/y33xj6rq intel-oneapi-compilers/2023.2.4/gcc/4lbvg4hv
    intel-oneapi-mpi/2021.12.1/intel/hlruk24n rhel8/cclake/intel
[INFO]: Creating replica output folder in /rds/user/lc2010/hpc-work/simunet_git/SIMUnet/tutorial/nnfit/replica_10
[WARNING]: Using q2min from runcard
[WARNING]: Using w2min from runcard
[INFO]: All requirements processed and checked successfully. Executing actions.
[INFO]: Loading integrability dataset INTEGXT8
[INFO]: Loading positivity dataset POSF2U
[INFO]: Clearing session
[INFO]: Setting the number of cores to: 2
[INFO]: Starting replica fit 10
[INFO]: Clearing session
[INFO]: Generating layers
2025-02-05 11:54:24.209857: E tensorflow/stream_executor/cuda/cuda_driver.cc:328] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
[INFO]: Using bsm_factor scales: [0.01, 0.1, 1.0, 1.0]
[INFO]: Generating layers for experiment HERACOMB
[INFO]: Generating layers for experiment CMS
[INFO]: Generating positivity penalty for POSF2U
[INFO]: Generating integrability penalty for INTEGXT8
[INFO]: Generating PDF models
[WARNING]: AutoGraph could not transform <bound method Preprocessing.call of <n3fit.layers.preprocessing.Preprocessing object at 0x154182809ac0>> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: module 'gast' has no attribute 'Index'
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING]: AutoGraph could not transform <bound method FkRotation.call of <n3fit.layers.rotations.FkRotation object at 0x15418b239400>> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: module 'gast' has no attribute 'Index'
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING]: AutoGraph could not transform <bound method MSR_Normalization.call of <n3fit.layers.msr_normalization.MSR_Normalization object at 0x15418b23c040>> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: module 'gast' has no attribute 'Index'
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2025-02-05 11:54:25.188643: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
[INFO]: Generating the Model
[WARNING]: AutoGraph could not transform <bound method DIS.call of <n3fit.layers.DIS.DIS object at 0x15418aa77d90>> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: module 'gast' has no attribute 'Index'
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING]: AutoGraph could not transform <bound method LossInvcovmat.call of <n3fit.layers.losses.LossInvcovmat object at 0x15416bcf54c0>> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: module 'gast' has no attribute 'Index'
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[WARNING]: AutoGraph could not transform <bound method DY.call of <n3fit.layers.DY.DY object at 0x154182832670>> and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: module 'gast' has no attribute 'Index'
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[INFO]: At epoch 100/30000, total chi2: 4.37537210995389
HERACOMB: 4.283, CMS: 4.721, total: 4.375
Validation chi2 at this point: 4.56469202041626
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 200/30000, total chi2: 2.457961210270518
HERACOMB: 2.494, CMS: 2.324, total: 2.458
Validation chi2 at this point: 2.5919480323791504
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 300/30000, total chi2: 2.1552864153360582
HERACOMB: 2.260, CMS: 1.766, total: 2.155
Validation chi2 at this point: 2.7832648754119873
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 400/30000, total chi2: 2.137638445981999
HERACOMB: 2.248, CMS: 1.727, total: 2.138
Validation chi2 at this point: 2.763150691986084
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 500/30000, total chi2: 2.1162769278300178
HERACOMB: 2.222, CMS: 1.722, total: 2.116
Validation chi2 at this point: 2.771740198135376
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 600/30000, total chi2: 2.0658921703849873
HERACOMB: 2.177, CMS: 1.651, total: 2.066
Validation chi2 at this point: 2.8277854919433594
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 700/30000, total chi2: 2.057100158376792
HERACOMB: 2.164, CMS: 1.659, total: 2.057
Validation chi2 at this point: 2.7442612648010254
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 800/30000, total chi2: 2.0381400904704616
HERACOMB: 2.155, CMS: 1.602, total: 2.038
Validation chi2 at this point: 2.8232476711273193
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 900/30000, total chi2: 2.0109436585731113
HERACOMB: 2.128, CMS: 1.575, total: 2.011
Validation chi2 at this point: 2.9199414253234863
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 1000/30000, total chi2: 2.0016621461848625
HERACOMB: 2.118, CMS: 1.566, total: 2.002
Validation chi2 at this point: 2.865086555480957
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 1100/30000, total chi2: 1.992366377840337
HERACOMB: 2.111, CMS: 1.551, total: 1.992
Validation chi2 at this point: 2.8616325855255127
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 1200/30000, total chi2: 1.9857454594877577
HERACOMB: 2.105, CMS: 1.540, total: 1.986
Validation chi2 at this point: 2.8415586948394775
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 1300/30000, total chi2: 1.9785166868229502
HERACOMB: 2.099, CMS: 1.528, total: 1.979
Validation chi2 at this point: 2.8228256702423096
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 1400/30000, total chi2: 1.9716743980486369
HERACOMB: 2.093, CMS: 1.520, total: 1.972
Validation chi2 at this point: 2.828326940536499
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 1500/30000, total chi2: 1.965259610992117
HERACOMB: 2.087, CMS: 1.509, total: 1.965
Validation chi2 at this point: 2.8398311138153076
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 1600/30000, total chi2: 1.9629861497387444
HERACOMB: 2.075, CMS: 1.544, total: 1.963
Validation chi2 at this point: 2.988399028778076
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 1700/30000, total chi2: 1.9493200557748067
HERACOMB: 2.071, CMS: 1.494, total: 1.949
Validation chi2 at this point: 2.8551857471466064
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 1800/30000, total chi2: 2.0006776790028993
HERACOMB: 2.115, CMS: 1.574, total: 2.001
Validation chi2 at this point: 2.8647620677948
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 1900/30000, total chi2: 1.9758864727216898
HERACOMB: 2.090, CMS: 1.551, total: 1.976
Validation chi2 at this point: 2.925853967666626
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 2000/30000, total chi2: 1.9755992496136539
HERACOMB: 2.092, CMS: 1.541, total: 1.976
Validation chi2 at this point: 2.8806889057159424
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 2100/30000, total chi2: 1.9605627944788981
HERACOMB: 2.086, CMS: 1.491, total: 1.961
Validation chi2 at this point: 2.974318027496338
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 2200/30000, total chi2: 1.9393781091749054
HERACOMB: 2.065, CMS: 1.472, total: 1.939
Validation chi2 at this point: 2.976266384124756
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 2300/30000, total chi2: 1.940710362699843
HERACOMB: 2.066, CMS: 1.474, total: 1.941
Validation chi2 at this point: 2.9002845287323
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 2400/30000, total chi2: 1.934036628487184
HERACOMB: 2.058, CMS: 1.470, total: 1.934
Validation chi2 at this point: 2.9109511375427246
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 2500/30000, total chi2: 1.9393143997978919
HERACOMB: 2.064, CMS: 1.475, total: 1.939
Validation chi2 at this point: 2.9961042404174805
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 2600/30000, total chi2: 1.9163118736031128
HERACOMB: 2.041, CMS: 1.450, total: 1.916
Validation chi2 at this point: 3.0282344818115234
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 2700/30000, total chi2: 1.9231445469807105
HERACOMB: 2.044, CMS: 1.471, total: 1.923
Validation chi2 at this point: 2.889723539352417
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 2800/30000, total chi2: 1.9041328036908023
HERACOMB: 2.031, CMS: 1.429, total: 1.904
Validation chi2 at this point: 2.9323530197143555
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 2900/30000, total chi2: 1.9065418440042083
HERACOMB: 2.032, CMS: 1.438, total: 1.907
Validation chi2 at this point: 2.927724599838257
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 3000/30000, total chi2: 1.9211130043894975
HERACOMB: 2.053, CMS: 1.428, total: 1.921
Validation chi2 at this point: 2.9452435970306396
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 3100/30000, total chi2: 1.9248258453054525
HERACOMB: 2.051, CMS: 1.455, total: 1.925
Validation chi2 at this point: 2.955801486968994
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 3200/30000, total chi2: 1.8909847220194709
HERACOMB: 2.016, CMS: 1.424, total: 1.891
Validation chi2 at this point: 2.9013187885284424
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 3300/30000, total chi2: 1.8836471518290412
HERACOMB: 2.011, CMS: 1.407, total: 1.884
Validation chi2 at this point: 3.075233221054077
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 3400/30000, total chi2: 1.900483396864429
HERACOMB: 2.020, CMS: 1.454, total: 1.900
Validation chi2 at this point: 2.925713300704956
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 3500/30000, total chi2: 1.9123851736796271
HERACOMB: 2.025, CMS: 1.493, total: 1.912
Validation chi2 at this point: 2.946160316467285
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 3600/30000, total chi2: 1.8939665568243598
HERACOMB: 2.019, CMS: 1.426, total: 1.894
Validation chi2 at this point: 3.0047996044158936
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 3700/30000, total chi2: 1.8970675910871053
HERACOMB: 2.015, CMS: 1.457, total: 1.897
Validation chi2 at this point: 2.917125701904297
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 3800/30000, total chi2: 1.8936631704114146
HERACOMB: 2.015, CMS: 1.440, total: 1.894
Validation chi2 at this point: 2.949439287185669
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 3900/30000, total chi2: 1.8802752150702722
HERACOMB: 2.005, CMS: 1.415, total: 1.880
Validation chi2 at this point: 3.0539655685424805
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 4000/30000, total chi2: 1.8757971930749637
HERACOMB: 2.003, CMS: 1.402, total: 1.876
Validation chi2 at this point: 3.0324437618255615
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 4100/30000, total chi2: 1.8726619838439311
HERACOMB: 2.000, CMS: 1.398, total: 1.873
Validation chi2 at this point: 3.0284650325775146
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 4200/30000, total chi2: 1.8654770408709025
HERACOMB: 1.993, CMS: 1.391, total: 1.865
Validation chi2 at this point: 3.0666255950927734
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 4300/30000, total chi2: 1.8654616247747362
HERACOMB: 1.994, CMS: 1.385, total: 1.865
Validation chi2 at this point: 3.1004629135131836
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 4400/30000, total chi2: 1.8640716985328911
HERACOMB: 1.992, CMS: 1.386, total: 1.864
Validation chi2 at this point: 3.0377228260040283
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 4500/30000, total chi2: 1.8688523007422377
HERACOMB: 1.993, CMS: 1.406, total: 1.869
Validation chi2 at this point: 3.085623025894165
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 4600/30000, total chi2: 1.8668619136220401
HERACOMB: 1.993, CMS: 1.395, total: 1.867
Validation chi2 at this point: 3.0624632835388184
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 4700/30000, total chi2: 1.8676675226270538
HERACOMB: 1.994, CMS: 1.397, total: 1.868
Validation chi2 at this point: 3.059239149093628
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 4800/30000, total chi2: 1.8698689372269148
HERACOMB: 1.995, CMS: 1.404, total: 1.870
Validation chi2 at this point: 3.063410997390747
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 4900/30000, total chi2: 1.8795795244039948
HERACOMB: 2.000, CMS: 1.430, total: 1.880
Validation chi2 at this point: 3.0086209774017334
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 5000/30000, total chi2: 1.8631181421968126
HERACOMB: 1.988, CMS: 1.398, total: 1.863
Validation chi2 at this point: 3.0086772441864014
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 5100/30000, total chi2: 1.8520841500193803
HERACOMB: 1.979, CMS: 1.379, total: 1.852
Validation chi2 at this point: 3.1324100494384766
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 5200/30000, total chi2: 1.8533865348579956
HERACOMB: 1.980, CMS: 1.381, total: 1.853
Validation chi2 at this point: 3.1076717376708984
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 5300/30000, total chi2: 1.8573879359923686
HERACOMB: 1.983, CMS: 1.389, total: 1.857
Validation chi2 at this point: 3.0945496559143066
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 5400/30000, total chi2: 1.8743697097621013
HERACOMB: 1.993, CMS: 1.431, total: 1.874
Validation chi2 at this point: 3.025118350982666
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 5500/30000, total chi2: 1.8595397005376129
HERACOMB: 1.977, CMS: 1.422, total: 1.860
Validation chi2 at this point: 3.0261216163635254
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 5600/30000, total chi2: 1.8452117565980892
HERACOMB: 1.972, CMS: 1.373, total: 1.845
Validation chi2 at this point: 3.0459930896759033
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 5700/30000, total chi2: 1.8403520682423384
HERACOMB: 1.966, CMS: 1.370, total: 1.840
Validation chi2 at this point: 3.051470994949341
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 5800/30000, total chi2: 1.8374720701237315
HERACOMB: 1.966, CMS: 1.359, total: 1.837
Validation chi2 at this point: 3.021202325820923
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 5900/30000, total chi2: 1.833394375044046
HERACOMB: 1.962, CMS: 1.355, total: 1.833
Validation chi2 at this point: 3.171968698501587
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 6000/30000, total chi2: 1.8315009284265262
HERACOMB: 1.961, CMS: 1.348, total: 1.832
Validation chi2 at this point: 3.2248613834381104
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: At epoch 6100/30000, total chi2: 1.844826511501037
HERACOMB: 1.969, CMS: 1.383, total: 1.845
Validation chi2 at this point: 3.137355327606201
[INFO]: ['-6.18e+00', '-6.07e-01', '0.00e+00', '7.30e-01']
[INFO]: Stopped at epoch=6181
[INFO]: Best fit for replica #10, chi2=1.189 (tr=2.447, vl=2.586)
[INFO]:  > Saving the weights for future in /rds/user/lc2010/hpc-work/simunet_git/SIMUnet/tutorial/nnfit/replica_10/weights.h5
